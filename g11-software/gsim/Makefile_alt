#! gnumake

#---------------------------------------------------
# The D. P. Weygand Makefile
#---------------------------------------------------
include $(CLAS_CMS)/Rules.make

ifdef USEBOSIO
BOSLIB= -lbosio$(ADD_DEBUG)
else
BOSLIB = -lfputil$(ADD_DEBUG) -lbos$(ADD_DEBUG) -lfpack$(ADD_DEBUG)
endif

STDLIBS= -L$(LOCAL_LIB) -L$(CLAS_LIB) -lclasEvent$(ADD_DEBUG) -leloss$(ADD_DEBUG) -lplib$(ADD_DEBUG) -lpid$(ADD_DEBUG) -lec$(ADD_DEBUG) -lcc$(ADD_DEBUG) -lsc$(ADD_DEBUG) -ltrk$(ADD_DEBUG) -ldc$(ADD_DEBUG) -llac$(ADD_DEBUG) -lst$(ADD_DEBUG)  -lpid$(ADD_DEBUG) -ltag$(ADD_DEBUG) -lscaler$(ADD_DEBUG) -lvertex$(ADD_DEBUG) -lbankdefs$(ADD_DEBUG) -lclasutil$(ADD_DEBUG)   -lc_bos_io$(ADD_DEBUG) -lrecutl$(ADD_DEBUG) -litape$(ADD_DEBUG) $(BOSLIB) -lc_bos_io$(ADD_DEBUG) -lmapmanager$(ADD_DEBUG)  -lonline_dummy$(ADD_DEBUG) -lc_cern$(ADD_DEBUG) -lpp -lpwaUtil$(ADD_DEBUG)

#use the newest cern library
CERNPATH= $(CERN_ROOT)/lib
CERNLIB= -L$(CERNPATH) -lpacklib
MATHLIB= -lm

FINCLUDE := $(FINCLUDE) -I./include
INCLUDE := $(INCLUDE) -I./include

CCSRCS:= 

FSRCS:= beg_run_summary.F bos_cc.F bos_cc_t.F bos_dc.F bos_dc_t.F bos_ec.F bos_ec1.F bos_ec1_t.F bos_ec_t.F bos_head.F bos_mcev.F bos_mcpa.F bos_st.F bos_tagr.F brubz.F calib_sc.F calib_sc_init.F cc1to2.F cc_vert.F cccompr.F ccdefk.F ccdefpar.F ccdein.F ccdigi.F ccdlin.F ccdln2.F ccdpln.F ccdraw.F ccdrawp.F ccframe.F ccfrsg.F ccfrwc.F ccinic.F ccitox.F cclast.F ccortbas.F ccout.F ccrefloc.F ccreflpl.F ccrefs.F ccrose.F ccrosh.F ccrotp.F ccshft.F ccstep.F cctosg.F cctowc.F cctrak.F cctrev.F ccturn.F ccturnx.F ccvcrpl.F ccview.F ccvpho.F ccwccr.F ccwcfrs.F ccwcmcr.F ccwcpar.F ccwcrf.F ccxtoi.F cfblkd.F cfcomd.F cfedep.F cfemsh.F cfgam1.F cfhdsh.F cfinit.F cfking.F cfnrot.F cfr2ex.F cfr2hx.F cfstat.F cfstep.F cfstmd.F cftrev.F cfvtmd.F clas_bckgr.F clas_bos.F clas_digi.F clas_ffgo.F clas_ffky.F clas_fld.F clas_geom.F clas_init.F clas_kine.F clas_last.F clas_out.F clas_part.F clas_phys.F clas_trak.F clas_trev.F digi_cc.F digi_dc.F digi_ec.F digi_ec1.F digi_sc.F digi_st.F digi_trig.F dusp.F ellipt.F ffky_bckgr.F ffky_cc.F ffky_dc.F ffky_ec.F ffky_ec1.F ffky_foil.F ffky_mg.F ffky_ptg.F ffky_sc.F ffky_st.F ffky_tg.F free_lun.F geom_cc.F geom_ec.F geom_ec1.F geom_ec1_ini.F geom_ec_init.F geom_eltg1.F geom_eltg2.F geom_foil.F geom_foil_new.F geom_mg.F geom_phtg1.F geom_phtg2.F geom_phtg3.F geom_phtg4.F geom_ptg.F geom_st.F geom_st_init.F geom_tg.F geom_tg_g7.F geom_usertg.F get_idtype.F get_lun.F get_mate.F get_part.F get_rotm.F get_sector.F get_tmed.F ggauss.F gmail.F gnpgon.F gsim_help.F gsimpar_2_bos.F gtnino.F gudigi.F gufld.F gukine.F guout.F guser_beg.F guser_book.F guser_bos.F guser_digi.F guser_ffky.F guser_fld.F guser_geom.F guser_hist.F guser_init.F guser_kine.F guser_last.F guser_part.F guser_phys.F guser_step.F guser_trak.F guser_trev.F guskip.F gustep.F gutrak.F gutrev.F init_cc.F init_dc.F init_ec.F init_ec1.F init_flags.F init_mate.F init_mg.F init_sc.F init_st.F init_tmed.F inuli.F kine_bogdan.F kine_liz.F kine_lund.F kine_mcin.F kine_mcin_t.F kine_smear_vx.F last_cc.F last_dc.F last_ec.F last_ec1.F last_sc.F last_st.F out_cc.F out_dc.F out_ec.F out_ec1.F out_sc.F out_st.F processevt.F ptg_field.F set_tpar.F sets_cc.F sets_dc.F sets_ec.F sets_ec1.F sets_sc.F sets_st.F sgnrot.F snake.F snake_ptg.F step_cc.F step_dc.F step_ec.F step_ec1.F step_sc.F step_st.F trev_cc.F trev_dc.F trev_ec.F trev_ec1.F trev_sc.F trev_st.F uftmed.F ugeom_tg_e1d.F ugeom_tg_e2.F ugeom_tg_e5.F uginit.F uglast.F utchmy.F 

SRCS:=  bos_sc.c  bos_sc_t.c  clas_step.c  geom_dc_c.c  geom_sc.c  gsim_bos.c  makehead.c  

FOBJS= $(patsubst %.F,$(OBJDIR)/%.o,$(FSRCS))
OBJS= $(patsubst %.c,$(OBJDIR)/%.o,$(SRCS))

CCOBJS= $(patsubst %.cc,$(OBJDIR)/%.o,$(CCSRCS))

all: lib 

LIBS= $(LOCAL_LIB)/libgsim$(ADD_DEBUG).a
lib: $(LIBS)

$(LIBS): $(OBJS) $(FOBJS) $(CCOBJS)
	$(VDIR) $(LOCAL_LIB)
	ar rv $@ $?
install: 
	$(VDIR) $(LOCAL_BIN)
env:
	@echo EXE $(EXE)
	@echo LIBS $(LIBS)
	@echo CC $(CC)
	@echo FC $(FC)
	@echo OS_NAME $(OS_NAME)
	@echo INCLUDE $(INCLUDE)
	@echo BOSPATH $(BOSPATH)
	@echo FLIB $(FLIB)
	@echo OBJS $(OBJS)
	@echo CFLAGS $(CFLAGS)
	@echo FFLAGS $(FFLAGS)
	@echo CCLAGS $(CCFAGS)
	@echo INCLUDE $(INCLUDE)
	@echo LOCAL_LIB $(LOCAL_LIB)
	@echo LOCAL_BIN $(LOCAL_BIN)
	@echo LOCAL_INCLUDE $(LOCAL_INCLUDE)
	@echo OBJDIR $(OBJDIR)
